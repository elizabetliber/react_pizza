{"ast":null,"code":"'use strict';\n\nconst {\n  createReadStream\n} = require('fs');\n\nconst {\n  join\n} = require('path');\n\nconst clientBasePath = join(__dirname, '..', '..', 'client');\n\nfunction routes(server) {\n  const app = server.app;\n  const middleware = server.middleware;\n  const options = server.options;\n  app.get('/__webpack_dev_server__/live.bundle.js', (req, res) => {\n    res.setHeader('Content-Type', 'application/javascript');\n    createReadStream(join(clientBasePath, 'live.bundle.js')).pipe(res);\n  });\n  app.get('/__webpack_dev_server__/sockjs.bundle.js', (req, res) => {\n    res.setHeader('Content-Type', 'application/javascript');\n    createReadStream(join(clientBasePath, 'sockjs.bundle.js')).pipe(res);\n  });\n  app.get('/webpack-dev-server.js', (req, res) => {\n    res.setHeader('Content-Type', 'application/javascript');\n    createReadStream(join(clientBasePath, 'index.bundle.js')).pipe(res);\n  });\n  app.get('/webpack-dev-server/invalidate', (_req, res) => {\n    server.invalidate();\n    res.end();\n  });\n  app.get('/webpack-dev-server/*', (req, res) => {\n    res.setHeader('Content-Type', 'text/html');\n    createReadStream(join(clientBasePath, 'live.html')).pipe(res);\n  });\n  app.get('/webpack-dev-server', (req, res) => {\n    res.setHeader('Content-Type', 'text/html');\n    res.write('<!DOCTYPE html><html><head><meta charset=\"utf-8\"/></head><body>');\n    const outputPath = middleware.getFilenameFromUrl(options.publicPath || '/');\n    const filesystem = middleware.fileSystem;\n    writeDirectory(options.publicPath || '/', outputPath);\n    res.end('</body></html>');\n\n    function writeDirectory(baseUrl, basePath) {\n      const content = filesystem.readdirSync(basePath);\n      res.write('<ul>');\n      content.forEach(item => {\n        const p = `${basePath}/${item}`;\n\n        if (filesystem.statSync(p).isFile()) {\n          res.write(`<li><a href=\"${baseUrl + item}\">${item}</a></li>`);\n\n          if (/\\.js$/.test(item)) {\n            const html = item.substr(0, item.length - 3);\n            const containerHref = baseUrl + html;\n            const magicHtmlHref = baseUrl.replace( // eslint-disable-next-line\n            /(^(https?:\\/\\/[^\\/]+)?\\/)/, '$1webpack-dev-server/') + html;\n            res.write(`<li><a href=\"${containerHref}\">${html}</a>` + ` (magic html for ${item}) (<a href=\"${magicHtmlHref}\">webpack-dev-server</a>)` + `</li>`);\n          }\n        } else {\n          res.write(`<li>${item}<br>`);\n          writeDirectory(`${baseUrl + item}/`, p);\n          res.write('</li>');\n        }\n      });\n      res.write('</ul>');\n    }\n  });\n}\n\nmodule.exports = routes;","map":{"version":3,"sources":["/home/lisa/VSProjects/react-pizza/react_pizza/node_modules/webpack-dev-server/lib/utils/routes.js"],"names":["createReadStream","require","join","clientBasePath","__dirname","routes","server","app","middleware","options","get","req","res","setHeader","pipe","_req","invalidate","end","write","outputPath","getFilenameFromUrl","publicPath","filesystem","fileSystem","writeDirectory","baseUrl","basePath","content","readdirSync","forEach","item","p","statSync","isFile","test","html","substr","length","containerHref","magicHtmlHref","replace","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nconst { createReadStream } = require('fs');\nconst { join } = require('path');\n\nconst clientBasePath = join(__dirname, '..', '..', 'client');\n\nfunction routes(server) {\n  const app = server.app;\n  const middleware = server.middleware;\n  const options = server.options;\n\n  app.get('/__webpack_dev_server__/live.bundle.js', (req, res) => {\n    res.setHeader('Content-Type', 'application/javascript');\n\n    createReadStream(join(clientBasePath, 'live.bundle.js')).pipe(res);\n  });\n\n  app.get('/__webpack_dev_server__/sockjs.bundle.js', (req, res) => {\n    res.setHeader('Content-Type', 'application/javascript');\n\n    createReadStream(join(clientBasePath, 'sockjs.bundle.js')).pipe(res);\n  });\n\n  app.get('/webpack-dev-server.js', (req, res) => {\n    res.setHeader('Content-Type', 'application/javascript');\n\n    createReadStream(join(clientBasePath, 'index.bundle.js')).pipe(res);\n  });\n\n  app.get('/webpack-dev-server/invalidate', (_req, res) => {\n    server.invalidate();\n    res.end();\n  });\n\n  app.get('/webpack-dev-server/*', (req, res) => {\n    res.setHeader('Content-Type', 'text/html');\n\n    createReadStream(join(clientBasePath, 'live.html')).pipe(res);\n  });\n\n  app.get('/webpack-dev-server', (req, res) => {\n    res.setHeader('Content-Type', 'text/html');\n\n    res.write(\n      '<!DOCTYPE html><html><head><meta charset=\"utf-8\"/></head><body>'\n    );\n\n    const outputPath = middleware.getFilenameFromUrl(options.publicPath || '/');\n    const filesystem = middleware.fileSystem;\n\n    writeDirectory(options.publicPath || '/', outputPath);\n\n    res.end('</body></html>');\n\n    function writeDirectory(baseUrl, basePath) {\n      const content = filesystem.readdirSync(basePath);\n\n      res.write('<ul>');\n\n      content.forEach((item) => {\n        const p = `${basePath}/${item}`;\n\n        if (filesystem.statSync(p).isFile()) {\n          res.write(`<li><a href=\"${baseUrl + item}\">${item}</a></li>`);\n\n          if (/\\.js$/.test(item)) {\n            const html = item.substr(0, item.length - 3);\n            const containerHref = baseUrl + html;\n\n            const magicHtmlHref =\n              baseUrl.replace(\n                // eslint-disable-next-line\n                /(^(https?:\\/\\/[^\\/]+)?\\/)/,\n                '$1webpack-dev-server/'\n              ) + html;\n\n            res.write(\n              `<li><a href=\"${containerHref}\">${html}</a>` +\n                ` (magic html for ${item}) (<a href=\"${magicHtmlHref}\">webpack-dev-server</a>)` +\n                `</li>`\n            );\n          }\n        } else {\n          res.write(`<li>${item}<br>`);\n\n          writeDirectory(`${baseUrl + item}/`, p);\n\n          res.write('</li>');\n        }\n      });\n\n      res.write('</ul>');\n    }\n  });\n}\n\nmodule.exports = routes;\n"]},"metadata":{},"sourceType":"script"}