{"ast":null,"code":"'use strict';\n\nvar RingBuffer = function (bufferSize) {\n  this._bufferSize = bufferSize;\n  this.clear();\n};\n\nRingBuffer.prototype.clear = function () {\n  this._buffer = new Array(this._bufferSize);\n  this._ringOffset = 0;\n  this._ringSize = this._bufferSize;\n  this._head = 0;\n  this._tail = 0;\n  this.length = 0;\n};\n\nRingBuffer.prototype.push = function (value) {\n  var expandBuffer = false,\n      expandRing = false;\n\n  if (this._ringSize < this._bufferSize) {\n    expandBuffer = this._tail === 0;\n  } else if (this._ringOffset === this._ringSize) {\n    expandBuffer = true;\n    expandRing = this._tail === 0;\n  }\n\n  if (expandBuffer) {\n    this._tail = this._bufferSize;\n    this._buffer = this._buffer.concat(new Array(this._bufferSize));\n    this._bufferSize = this._buffer.length;\n    if (expandRing) this._ringSize = this._bufferSize;\n  }\n\n  this._buffer[this._tail] = value;\n  this.length += 1;\n  if (this._tail < this._ringSize) this._ringOffset += 1;\n  this._tail = (this._tail + 1) % this._bufferSize;\n};\n\nRingBuffer.prototype.peek = function () {\n  if (this.length === 0) return void 0;\n  return this._buffer[this._head];\n};\n\nRingBuffer.prototype.shift = function () {\n  if (this.length === 0) return void 0;\n  var value = this._buffer[this._head];\n  this._buffer[this._head] = void 0;\n  this.length -= 1;\n  this._ringOffset -= 1;\n\n  if (this._ringOffset === 0 && this.length > 0) {\n    this._head = this._ringSize;\n    this._ringOffset = this.length;\n    this._ringSize = this._bufferSize;\n  } else {\n    this._head = (this._head + 1) % this._ringSize;\n  }\n\n  return value;\n};\n\nmodule.exports = RingBuffer;","map":{"version":3,"sources":["/home/lisa/VSProjects/react-pizza/react_pizza/node_modules/websocket-extensions/lib/pipeline/ring_buffer.js"],"names":["RingBuffer","bufferSize","_bufferSize","clear","prototype","_buffer","Array","_ringOffset","_ringSize","_head","_tail","length","push","value","expandBuffer","expandRing","concat","peek","shift","module","exports"],"mappings":"AAAA;;AAEA,IAAIA,UAAU,GAAG,UAASC,UAAT,EAAqB;AACpC,OAAKC,WAAL,GAAmBD,UAAnB;AACA,OAAKE,KAAL;AACD,CAHD;;AAKAH,UAAU,CAACI,SAAX,CAAqBD,KAArB,GAA6B,YAAW;AACtC,OAAKE,OAAL,GAAmB,IAAIC,KAAJ,CAAU,KAAKJ,WAAf,CAAnB;AACA,OAAKK,WAAL,GAAmB,CAAnB;AACA,OAAKC,SAAL,GAAmB,KAAKN,WAAxB;AACA,OAAKO,KAAL,GAAmB,CAAnB;AACA,OAAKC,KAAL,GAAmB,CAAnB;AACA,OAAKC,MAAL,GAAmB,CAAnB;AACD,CAPD;;AASAX,UAAU,CAACI,SAAX,CAAqBQ,IAArB,GAA4B,UAASC,KAAT,EAAgB;AAC1C,MAAIC,YAAY,GAAG,KAAnB;AAAA,MACIC,UAAU,GAAK,KADnB;;AAGA,MAAI,KAAKP,SAAL,GAAiB,KAAKN,WAA1B,EAAuC;AACrCY,IAAAA,YAAY,GAAI,KAAKJ,KAAL,KAAe,CAA/B;AACD,GAFD,MAEO,IAAI,KAAKH,WAAL,KAAqB,KAAKC,SAA9B,EAAyC;AAC9CM,IAAAA,YAAY,GAAG,IAAf;AACAC,IAAAA,UAAU,GAAM,KAAKL,KAAL,KAAe,CAA/B;AACD;;AAED,MAAII,YAAJ,EAAkB;AAChB,SAAKJ,KAAL,GAAmB,KAAKR,WAAxB;AACA,SAAKG,OAAL,GAAmB,KAAKA,OAAL,CAAaW,MAAb,CAAoB,IAAIV,KAAJ,CAAU,KAAKJ,WAAf,CAApB,CAAnB;AACA,SAAKA,WAAL,GAAmB,KAAKG,OAAL,CAAaM,MAAhC;AAEA,QAAII,UAAJ,EACE,KAAKP,SAAL,GAAiB,KAAKN,WAAtB;AACH;;AAED,OAAKG,OAAL,CAAa,KAAKK,KAAlB,IAA2BG,KAA3B;AACA,OAAKF,MAAL,IAAe,CAAf;AACA,MAAI,KAAKD,KAAL,GAAa,KAAKF,SAAtB,EAAiC,KAAKD,WAAL,IAAoB,CAApB;AACjC,OAAKG,KAAL,GAAa,CAAC,KAAKA,KAAL,GAAa,CAAd,IAAmB,KAAKR,WAArC;AACD,CAxBD;;AA0BAF,UAAU,CAACI,SAAX,CAAqBa,IAArB,GAA4B,YAAW;AACrC,MAAI,KAAKN,MAAL,KAAgB,CAApB,EAAuB,OAAO,KAAK,CAAZ;AACvB,SAAO,KAAKN,OAAL,CAAa,KAAKI,KAAlB,CAAP;AACD,CAHD;;AAKAT,UAAU,CAACI,SAAX,CAAqBc,KAArB,GAA6B,YAAW;AACtC,MAAI,KAAKP,MAAL,KAAgB,CAApB,EAAuB,OAAO,KAAK,CAAZ;AAEvB,MAAIE,KAAK,GAAG,KAAKR,OAAL,CAAa,KAAKI,KAAlB,CAAZ;AACA,OAAKJ,OAAL,CAAa,KAAKI,KAAlB,IAA2B,KAAK,CAAhC;AACA,OAAKE,MAAL,IAAe,CAAf;AACA,OAAKJ,WAAL,IAAoB,CAApB;;AAEA,MAAI,KAAKA,WAAL,KAAqB,CAArB,IAA0B,KAAKI,MAAL,GAAc,CAA5C,EAA+C;AAC7C,SAAKF,KAAL,GAAmB,KAAKD,SAAxB;AACA,SAAKD,WAAL,GAAmB,KAAKI,MAAxB;AACA,SAAKH,SAAL,GAAmB,KAAKN,WAAxB;AACD,GAJD,MAIO;AACL,SAAKO,KAAL,GAAa,CAAC,KAAKA,KAAL,GAAa,CAAd,IAAmB,KAAKD,SAArC;AACD;;AACD,SAAOK,KAAP;AACD,CAhBD;;AAkBAM,MAAM,CAACC,OAAP,GAAiBpB,UAAjB","sourcesContent":["'use strict';\n\nvar RingBuffer = function(bufferSize) {\n  this._bufferSize = bufferSize;\n  this.clear();\n};\n\nRingBuffer.prototype.clear = function() {\n  this._buffer     = new Array(this._bufferSize);\n  this._ringOffset = 0;\n  this._ringSize   = this._bufferSize;\n  this._head       = 0;\n  this._tail       = 0;\n  this.length      = 0;\n};\n\nRingBuffer.prototype.push = function(value) {\n  var expandBuffer = false,\n      expandRing   = false;\n\n  if (this._ringSize < this._bufferSize) {\n    expandBuffer = (this._tail === 0);\n  } else if (this._ringOffset === this._ringSize) {\n    expandBuffer = true;\n    expandRing   = (this._tail === 0);\n  }\n\n  if (expandBuffer) {\n    this._tail       = this._bufferSize;\n    this._buffer     = this._buffer.concat(new Array(this._bufferSize));\n    this._bufferSize = this._buffer.length;\n\n    if (expandRing)\n      this._ringSize = this._bufferSize;\n  }\n\n  this._buffer[this._tail] = value;\n  this.length += 1;\n  if (this._tail < this._ringSize) this._ringOffset += 1;\n  this._tail = (this._tail + 1) % this._bufferSize;\n};\n\nRingBuffer.prototype.peek = function() {\n  if (this.length === 0) return void 0;\n  return this._buffer[this._head];\n};\n\nRingBuffer.prototype.shift = function() {\n  if (this.length === 0) return void 0;\n\n  var value = this._buffer[this._head];\n  this._buffer[this._head] = void 0;\n  this.length -= 1;\n  this._ringOffset -= 1;\n\n  if (this._ringOffset === 0 && this.length > 0) {\n    this._head       = this._ringSize;\n    this._ringOffset = this.length;\n    this._ringSize   = this._bufferSize;\n  } else {\n    this._head = (this._head + 1) % this._ringSize;\n  }\n  return value;\n};\n\nmodule.exports = RingBuffer;\n"]},"metadata":{},"sourceType":"script"}