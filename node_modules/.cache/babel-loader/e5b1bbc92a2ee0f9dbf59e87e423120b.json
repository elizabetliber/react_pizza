{"ast":null,"code":"// Generated by CoffeeScript 1.12.7\n(function () {\n  var App,\n      Listener,\n      Server,\n      chunking_test,\n      events,\n      fs,\n      generate_dispatcher,\n      iframe,\n      sockjsVersion,\n      trans_eventsource,\n      trans_htmlfile,\n      trans_jsonp,\n      trans_websocket,\n      trans_xhr,\n      utils,\n      webjs,\n      extend = function (child, parent) {\n    for (var key in parent) {\n      if (hasProp.call(parent, key)) child[key] = parent[key];\n    }\n\n    function ctor() {\n      this.constructor = child;\n    }\n\n    ctor.prototype = parent.prototype;\n    child.prototype = new ctor();\n    child.__super__ = parent.prototype;\n    return child;\n  },\n      hasProp = {}.hasOwnProperty,\n      bind = function (fn, me) {\n    return function () {\n      return fn.apply(me, arguments);\n    };\n  };\n\n  events = require('events');\n  fs = require('fs');\n  webjs = require('./webjs');\n  utils = require('./utils');\n  trans_websocket = require('./trans-websocket');\n  trans_jsonp = require('./trans-jsonp');\n  trans_xhr = require('./trans-xhr');\n  iframe = require('./iframe');\n  trans_eventsource = require('./trans-eventsource');\n  trans_htmlfile = require('./trans-htmlfile');\n  chunking_test = require('./chunking-test');\n\n  sockjsVersion = function () {\n    var pkg, x;\n\n    try {\n      pkg = fs.readFileSync(__dirname + '/../package.json', 'utf-8');\n    } catch (error) {\n      x = error;\n    }\n\n    if (pkg) {\n      return JSON.parse(pkg).version;\n    } else {\n      return null;\n    }\n  };\n\n  App = function (superClass) {\n    extend(App, superClass);\n\n    function App() {\n      return App.__super__.constructor.apply(this, arguments);\n    }\n\n    App.prototype.welcome_screen = function (req, res) {\n      res.setHeader('content-type', 'text/plain; charset=UTF-8');\n      res.writeHead(200);\n      res.end(\"Welcome to SockJS!\\n\");\n      return true;\n    };\n\n    App.prototype.handle_404 = function (req, res) {\n      res.setHeader('content-type', 'text/plain; charset=UTF-8');\n      res.writeHead(404);\n      res.end('404 Error: Page not found\\n');\n      return true;\n    };\n\n    App.prototype.disabled_transport = function (req, res, data) {\n      return this.handle_404(req, res, data);\n    };\n\n    App.prototype.h_sid = function (req, res, data) {\n      var jsid;\n      req.cookies = utils.parseCookie(req.headers.cookie);\n\n      if (typeof this.options.jsessionid === 'function') {\n        this.options.jsessionid(req, res);\n      } else if (this.options.jsessionid && res.setHeader) {\n        jsid = req.cookies['JSESSIONID'] || 'dummy';\n        res.setHeader('Set-Cookie', 'JSESSIONID=' + jsid + '; path=/');\n      }\n\n      return data;\n    };\n\n    App.prototype.log = function (severity, line) {\n      return this.options.log(severity, line);\n    };\n\n    return App;\n  }(webjs.GenericApp);\n\n  utils.objectExtend(App.prototype, iframe.app);\n  utils.objectExtend(App.prototype, chunking_test.app);\n  utils.objectExtend(App.prototype, trans_websocket.app);\n  utils.objectExtend(App.prototype, trans_jsonp.app);\n  utils.objectExtend(App.prototype, trans_xhr.app);\n  utils.objectExtend(App.prototype, trans_eventsource.app);\n  utils.objectExtend(App.prototype, trans_htmlfile.app);\n\n  generate_dispatcher = function (options) {\n    var opts_filters, p, prefix_dispatcher, t, transport_dispatcher;\n\n    p = function (_this) {\n      return function (s) {\n        return new RegExp('^' + options.prefix + s + '[/]?$');\n      };\n    }(this);\n\n    t = function (_this) {\n      return function (s) {\n        return [p('/([^/.]+)/([^/.]+)' + s), 'server', 'session'];\n      };\n    }(this);\n\n    opts_filters = function (options_filter) {\n      if (options_filter == null) {\n        options_filter = 'xhr_options';\n      }\n\n      return ['h_sid', 'xhr_cors', 'cache_for', options_filter, 'expose'];\n    };\n\n    prefix_dispatcher = [['GET', p(''), ['welcome_screen']], ['GET', p('/iframe[0-9-.a-z_]*.html'), ['iframe', 'cache_for', 'expose']], ['OPTIONS', p('/info'), opts_filters('info_options')], ['GET', p('/info'), ['xhr_cors', 'h_no_cache', 'info', 'expose']], ['OPTIONS', p('/chunking_test'), opts_filters()], ['POST', p('/chunking_test'), ['xhr_cors', 'expect_xhr', 'chunking_test']]];\n    transport_dispatcher = [['GET', t('/jsonp'), ['h_sid', 'h_no_cache', 'jsonp']], ['POST', t('/jsonp_send'), ['h_sid', 'h_no_cache', 'expect_form', 'jsonp_send']], ['POST', t('/xhr'), ['h_sid', 'h_no_cache', 'xhr_cors', 'xhr_poll']], ['OPTIONS', t('/xhr'), opts_filters()], ['POST', t('/xhr_send'), ['h_sid', 'h_no_cache', 'xhr_cors', 'expect_xhr', 'xhr_send']], ['OPTIONS', t('/xhr_send'), opts_filters()], ['POST', t('/xhr_streaming'), ['h_sid', 'h_no_cache', 'xhr_cors', 'xhr_streaming']], ['OPTIONS', t('/xhr_streaming'), opts_filters()], ['GET', t('/eventsource'), ['h_sid', 'h_no_cache', 'eventsource']], ['GET', t('/htmlfile'), ['h_sid', 'h_no_cache', 'htmlfile']]];\n\n    if (options.websocket) {\n      prefix_dispatcher.push(['GET', p('/websocket'), ['raw_websocket']]);\n      transport_dispatcher.push(['GET', t('/websocket'), ['sockjs_websocket']]);\n    } else {\n      prefix_dispatcher.push(['GET', p('/websocket'), ['cache_for', 'disabled_transport']]);\n      transport_dispatcher.push(['GET', t('/websocket'), ['cache_for', 'disabled_transport']]);\n    }\n\n    return prefix_dispatcher.concat(transport_dispatcher);\n  };\n\n  Listener = function () {\n    function Listener(options1, emit) {\n      this.options = options1;\n      this.handler = bind(this.handler, this);\n      this.app = new App();\n      this.app.options = this.options;\n      this.app.emit = emit;\n      this.app.log('debug', 'SockJS v' + sockjsVersion() + ' ' + 'bound to ' + JSON.stringify(this.options.prefix));\n      this.dispatcher = generate_dispatcher(this.options);\n      this.webjs_handler = webjs.generateHandler(this.app, this.dispatcher);\n      this.path_regexp = new RegExp('^' + this.options.prefix + '([/].+|[/]?)$');\n    }\n\n    Listener.prototype.handler = function (req, res, extra) {\n      if (!req.url.match(this.path_regexp)) {\n        return false;\n      }\n\n      this.webjs_handler(req, res, extra);\n      return true;\n    };\n\n    Listener.prototype.getHandler = function () {\n      return function (_this) {\n        return function (a, b, c) {\n          return _this.handler(a, b, c);\n        };\n      }(this);\n    };\n\n    return Listener;\n  }();\n\n  Server = function (superClass) {\n    extend(Server, superClass);\n\n    function Server(user_options) {\n      this.options = {\n        prefix: '',\n        response_limit: 128 * 1024,\n        websocket: true,\n        faye_server_options: null,\n        jsessionid: false,\n        heartbeat_delay: 25000,\n        disconnect_delay: 5000,\n        log: function (severity, line) {\n          return console.log(line);\n        },\n        sockjs_url: 'https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js'\n      };\n\n      if (user_options) {\n        utils.objectExtend(this.options, user_options);\n      }\n    }\n\n    Server.prototype.listener = function (handler_options) {\n      var options;\n      options = utils.objectExtend({}, this.options);\n\n      if (handler_options) {\n        utils.objectExtend(options, handler_options);\n      }\n\n      return new Listener(options, function (_this) {\n        return function () {\n          return _this.emit.apply(_this, arguments);\n        };\n      }(this));\n    };\n\n    Server.prototype.installHandlers = function (http_server, handler_options) {\n      var handler;\n      handler = this.listener(handler_options).getHandler();\n      utils.overshadowListeners(http_server, 'request', handler);\n      utils.overshadowListeners(http_server, 'upgrade', handler);\n      return true;\n    };\n\n    Server.prototype.middleware = function (handler_options) {\n      var handler;\n      handler = this.listener(handler_options).getHandler();\n      handler.upgrade = handler;\n      return handler;\n    };\n\n    return Server;\n  }(events.EventEmitter);\n\n  exports.createServer = function (options) {\n    return new Server(options);\n  };\n\n  exports.listen = function (http_server, options) {\n    var srv;\n    srv = exports.createServer(options);\n\n    if (http_server) {\n      srv.installHandlers(http_server);\n    }\n\n    return srv;\n  };\n}).call(this);","map":{"version":3,"sources":["/home/lisa/VSProjects/react-pizza/react_pizza/node_modules/sockjs/lib/sockjs.js"],"names":["App","Listener","Server","chunking_test","events","fs","generate_dispatcher","iframe","sockjsVersion","trans_eventsource","trans_htmlfile","trans_jsonp","trans_websocket","trans_xhr","utils","webjs","extend","child","parent","key","hasProp","call","ctor","constructor","prototype","__super__","hasOwnProperty","bind","fn","me","apply","arguments","require","pkg","x","readFileSync","__dirname","error","JSON","parse","version","superClass","welcome_screen","req","res","setHeader","writeHead","end","handle_404","disabled_transport","data","h_sid","jsid","cookies","parseCookie","headers","cookie","options","jsessionid","log","severity","line","GenericApp","objectExtend","app","opts_filters","p","prefix_dispatcher","t","transport_dispatcher","_this","s","RegExp","prefix","options_filter","websocket","push","concat","options1","emit","handler","stringify","dispatcher","webjs_handler","generateHandler","path_regexp","extra","url","match","getHandler","a","b","c","user_options","response_limit","faye_server_options","heartbeat_delay","disconnect_delay","console","sockjs_url","listener","handler_options","installHandlers","http_server","overshadowListeners","middleware","upgrade","EventEmitter","exports","createServer","listen","srv"],"mappings":"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","sourcesContent":["// Generated by CoffeeScript 1.12.7\n(function() {\n  var App, Listener, Server, chunking_test, events, fs, generate_dispatcher, iframe, sockjsVersion, trans_eventsource, trans_htmlfile, trans_jsonp, trans_websocket, trans_xhr, utils, webjs,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty,\n    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\n  events = require('events');\n\n  fs = require('fs');\n\n  webjs = require('./webjs');\n\n  utils = require('./utils');\n\n  trans_websocket = require('./trans-websocket');\n\n  trans_jsonp = require('./trans-jsonp');\n\n  trans_xhr = require('./trans-xhr');\n\n  iframe = require('./iframe');\n\n  trans_eventsource = require('./trans-eventsource');\n\n  trans_htmlfile = require('./trans-htmlfile');\n\n  chunking_test = require('./chunking-test');\n\n  sockjsVersion = function() {\n    var pkg, x;\n    try {\n      pkg = fs.readFileSync(__dirname + '/../package.json', 'utf-8');\n    } catch (error) {\n      x = error;\n    }\n    if (pkg) {\n      return JSON.parse(pkg).version;\n    } else {\n      return null;\n    }\n  };\n\n  App = (function(superClass) {\n    extend(App, superClass);\n\n    function App() {\n      return App.__super__.constructor.apply(this, arguments);\n    }\n\n    App.prototype.welcome_screen = function(req, res) {\n      res.setHeader('content-type', 'text/plain; charset=UTF-8');\n      res.writeHead(200);\n      res.end(\"Welcome to SockJS!\\n\");\n      return true;\n    };\n\n    App.prototype.handle_404 = function(req, res) {\n      res.setHeader('content-type', 'text/plain; charset=UTF-8');\n      res.writeHead(404);\n      res.end('404 Error: Page not found\\n');\n      return true;\n    };\n\n    App.prototype.disabled_transport = function(req, res, data) {\n      return this.handle_404(req, res, data);\n    };\n\n    App.prototype.h_sid = function(req, res, data) {\n      var jsid;\n      req.cookies = utils.parseCookie(req.headers.cookie);\n      if (typeof this.options.jsessionid === 'function') {\n        this.options.jsessionid(req, res);\n      } else if (this.options.jsessionid && res.setHeader) {\n        jsid = req.cookies['JSESSIONID'] || 'dummy';\n        res.setHeader('Set-Cookie', 'JSESSIONID=' + jsid + '; path=/');\n      }\n      return data;\n    };\n\n    App.prototype.log = function(severity, line) {\n      return this.options.log(severity, line);\n    };\n\n    return App;\n\n  })(webjs.GenericApp);\n\n  utils.objectExtend(App.prototype, iframe.app);\n\n  utils.objectExtend(App.prototype, chunking_test.app);\n\n  utils.objectExtend(App.prototype, trans_websocket.app);\n\n  utils.objectExtend(App.prototype, trans_jsonp.app);\n\n  utils.objectExtend(App.prototype, trans_xhr.app);\n\n  utils.objectExtend(App.prototype, trans_eventsource.app);\n\n  utils.objectExtend(App.prototype, trans_htmlfile.app);\n\n  generate_dispatcher = function(options) {\n    var opts_filters, p, prefix_dispatcher, t, transport_dispatcher;\n    p = (function(_this) {\n      return function(s) {\n        return new RegExp('^' + options.prefix + s + '[/]?$');\n      };\n    })(this);\n    t = (function(_this) {\n      return function(s) {\n        return [p('/([^/.]+)/([^/.]+)' + s), 'server', 'session'];\n      };\n    })(this);\n    opts_filters = function(options_filter) {\n      if (options_filter == null) {\n        options_filter = 'xhr_options';\n      }\n      return ['h_sid', 'xhr_cors', 'cache_for', options_filter, 'expose'];\n    };\n    prefix_dispatcher = [['GET', p(''), ['welcome_screen']], ['GET', p('/iframe[0-9-.a-z_]*.html'), ['iframe', 'cache_for', 'expose']], ['OPTIONS', p('/info'), opts_filters('info_options')], ['GET', p('/info'), ['xhr_cors', 'h_no_cache', 'info', 'expose']], ['OPTIONS', p('/chunking_test'), opts_filters()], ['POST', p('/chunking_test'), ['xhr_cors', 'expect_xhr', 'chunking_test']]];\n    transport_dispatcher = [['GET', t('/jsonp'), ['h_sid', 'h_no_cache', 'jsonp']], ['POST', t('/jsonp_send'), ['h_sid', 'h_no_cache', 'expect_form', 'jsonp_send']], ['POST', t('/xhr'), ['h_sid', 'h_no_cache', 'xhr_cors', 'xhr_poll']], ['OPTIONS', t('/xhr'), opts_filters()], ['POST', t('/xhr_send'), ['h_sid', 'h_no_cache', 'xhr_cors', 'expect_xhr', 'xhr_send']], ['OPTIONS', t('/xhr_send'), opts_filters()], ['POST', t('/xhr_streaming'), ['h_sid', 'h_no_cache', 'xhr_cors', 'xhr_streaming']], ['OPTIONS', t('/xhr_streaming'), opts_filters()], ['GET', t('/eventsource'), ['h_sid', 'h_no_cache', 'eventsource']], ['GET', t('/htmlfile'), ['h_sid', 'h_no_cache', 'htmlfile']]];\n    if (options.websocket) {\n      prefix_dispatcher.push(['GET', p('/websocket'), ['raw_websocket']]);\n      transport_dispatcher.push(['GET', t('/websocket'), ['sockjs_websocket']]);\n    } else {\n      prefix_dispatcher.push(['GET', p('/websocket'), ['cache_for', 'disabled_transport']]);\n      transport_dispatcher.push(['GET', t('/websocket'), ['cache_for', 'disabled_transport']]);\n    }\n    return prefix_dispatcher.concat(transport_dispatcher);\n  };\n\n  Listener = (function() {\n    function Listener(options1, emit) {\n      this.options = options1;\n      this.handler = bind(this.handler, this);\n      this.app = new App();\n      this.app.options = this.options;\n      this.app.emit = emit;\n      this.app.log('debug', 'SockJS v' + sockjsVersion() + ' ' + 'bound to ' + JSON.stringify(this.options.prefix));\n      this.dispatcher = generate_dispatcher(this.options);\n      this.webjs_handler = webjs.generateHandler(this.app, this.dispatcher);\n      this.path_regexp = new RegExp('^' + this.options.prefix + '([/].+|[/]?)$');\n    }\n\n    Listener.prototype.handler = function(req, res, extra) {\n      if (!req.url.match(this.path_regexp)) {\n        return false;\n      }\n      this.webjs_handler(req, res, extra);\n      return true;\n    };\n\n    Listener.prototype.getHandler = function() {\n      return (function(_this) {\n        return function(a, b, c) {\n          return _this.handler(a, b, c);\n        };\n      })(this);\n    };\n\n    return Listener;\n\n  })();\n\n  Server = (function(superClass) {\n    extend(Server, superClass);\n\n    function Server(user_options) {\n      this.options = {\n        prefix: '',\n        response_limit: 128 * 1024,\n        websocket: true,\n        faye_server_options: null,\n        jsessionid: false,\n        heartbeat_delay: 25000,\n        disconnect_delay: 5000,\n        log: function(severity, line) {\n          return console.log(line);\n        },\n        sockjs_url: 'https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js'\n      };\n      if (user_options) {\n        utils.objectExtend(this.options, user_options);\n      }\n    }\n\n    Server.prototype.listener = function(handler_options) {\n      var options;\n      options = utils.objectExtend({}, this.options);\n      if (handler_options) {\n        utils.objectExtend(options, handler_options);\n      }\n      return new Listener(options, (function(_this) {\n        return function() {\n          return _this.emit.apply(_this, arguments);\n        };\n      })(this));\n    };\n\n    Server.prototype.installHandlers = function(http_server, handler_options) {\n      var handler;\n      handler = this.listener(handler_options).getHandler();\n      utils.overshadowListeners(http_server, 'request', handler);\n      utils.overshadowListeners(http_server, 'upgrade', handler);\n      return true;\n    };\n\n    Server.prototype.middleware = function(handler_options) {\n      var handler;\n      handler = this.listener(handler_options).getHandler();\n      handler.upgrade = handler;\n      return handler;\n    };\n\n    return Server;\n\n  })(events.EventEmitter);\n\n  exports.createServer = function(options) {\n    return new Server(options);\n  };\n\n  exports.listen = function(http_server, options) {\n    var srv;\n    srv = exports.createServer(options);\n    if (http_server) {\n      srv.installHandlers(http_server);\n    }\n    return srv;\n  };\n\n}).call(this);\n"]},"metadata":{},"sourceType":"script"}